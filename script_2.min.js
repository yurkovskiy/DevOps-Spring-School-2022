#!/usr/bin/node
const{exec:exec}=require("child_process"),readline=require("readline"),https=require("https"),options={hostname:"dtapi.if.ua",port:443,path:"/answer.php",method:"POST",headers:{"Content-type":"application/json;charset=utf8"}},COLOR={FgRed:"[31m",FgGreen:"[32m",FgYellow:"[33m",FgBlue:"[34m",FgWhite:"[37m",Reset:"[0m"};let kernel,answer;console.log(COLOR.FgGreen,"DevOps Spring School 2022 [Script #2]"),console.log(COLOR.FgYellow,"(c) Yuriy V. Bezgachnyuk 2022"),console.log(COLOR.Reset);const question=readline.createInterface({input:process.stdin,output:process.stdout});question.question("Please Enter the kernel release of your system:  ",e=>{console.log(COLOR.FgGreen,`Thank you for your input: ${e}`),question.close(),exec("uname -r",(o,s,n)=>{if(o)return void console.log(COLOR.FgRed,`error: ${o.message}`);if(n)return void console.log(COLOR.FgRed,`stderr: ${n}`);if(answer=s,0!==e.localeCompare(answer.trim()))return console.log(COLOR.FgRed,"Your answer is incorrect"),void console.log(COLOR.Reset,"The result hasn't been saved! You can try again");console.log(COLOR.FgGreen,"You are the Rock!");const t=https.request(options,e=>{console.log(COLOR.Reset),console.log("\n"),console.log(`status: ${e.statusCode}`),e.on("data",e=>{process.stdout.write(e)})});t.on("error",e=>{console.log(COLOR.FgRed,"Something wrong when sending data to the server. \n Please try again later"),console.log(COLOR.FgWhite,"Excuse me for the problems on the our side"),console.log(COLOR.Reset)});let r={answer:e,script_answer:answer,additional_data:`USER: ${process.env.USER} PWD: ${process.env.PWD} SHELL: ${process.env.SHELL}`};t.write(JSON.stringify(r)),t.end()})});

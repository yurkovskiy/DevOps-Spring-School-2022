#!/usr/bin/node
const{exec:exec}=require("child_process");const readline=require("readline");const https=require("https");const options={hostname:"dtapi.if.ua",port:443,path:"/answer.php",method:"POST",headers:{"Content-type":"application/json;charset=utf8"}};const COLOR={FgRed:"[31m",FgGreen:"[32m",FgYellow:"[33m",FgBlue:"[34m",FgWhite:"[37m",Reset:"[0m"};console.log(COLOR.FgGreen,"DevOps Spring School 2022 [Script #2]");console.log(COLOR.FgYellow,"(c) Yuriy V. Bezgachnyuk 2022");console.log(COLOR.Reset);let kernel;let answer;const question=readline.createInterface({input:process.stdin,output:process.stdout});question.question("Please Enter the kernel release of your system:  ",kernel=>{console.log(COLOR.FgGreen,`Thank you for your input: ${kernel}`);question.close();exec("uname -r",(error,stdout,stderr)=>{if(error){console.log(COLOR.FgRed,`error: ${error.message}`);return}if(stderr){console.log(COLOR.FgRed,`stderr: ${stderr}`);return}answer=stdout;let cmp=kernel.localeCompare(answer.trim());if(cmp===0){console.log(COLOR.FgGreen,"You are Rock!")}else{console.log(COLOR.FgRed,"Your answer is incorrect");console.log(COLOR.Reset,"The result hasn't been saved! You can try again");return}const req=https.request(options,res=>{console.log(COLOR.Reset);console.log("\n");console.log(`status: ${res.statusCode}`);res.on("data",d=>{process.stdout.write(d)})});let data={answer:kernel,script_answer:answer,additional_data:`USER: ${process.env.USER} PWD: ${process.env.PWD} SHELL: ${process.env.SHELL}`};req.write(JSON.stringify(data));req.end()})});
